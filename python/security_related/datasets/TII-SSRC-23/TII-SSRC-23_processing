import json
import pandas as pd

# Load suricata eve.json
with open("../logs/suricata/eve.json", "r") as f:
    suricata_data = [json.loads(line) for line in f]

# Convert to DataFrame
suricata_df = pd.json_normalize(suricata_data)

# Keep only relevant columns (modify as needed)
suricata_df = suricata_df[['src_ip', 'src_port', 'dest_ip', 'dest_port', 'timestamp', 'proto', 'flow.alerted']]

suricata_df.to_json("processed_suricata.json", orient="records", lines=True)


# Load the ground truth CSV file correctly
ground_truth_df = pd.read_csv("../ground_truth/Bruteforce FTP.csv")

# Select relevant columns (ensure these column names exist in your CSV)
ground_truth_df = ground_truth_df[['Src IP', 'Src Port', 'Dst IP', 'Dst Port', 'Protocol', 'Timestamp', 
                                   'Label', 'Traffic Type', 'Traffic Subtype']]

ground_truth_df.to_json("processed_ground_truth.json", orient="records", lines=True)

